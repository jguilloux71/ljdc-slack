#!/usr/bin/python3


#-------------------------------------------------------------------------------------------------------------
# Import Python libraries
import os
import sys
from pathlib import Path

# Add the current execution directory name to SYSPATH to import easily the custom libraries
full_path = os.path.dirname(Path(__file__))
sys.path.append(str(full_path))

# Import Custom libraries
from logger import logger
import ljdc
import slack
#-------------------------------------------------------------------------------------------------------------




#-------------------------------------------------------------------------------------------------------------
logger.info("Let's get started")
#-------------------------------------------------------------------------------------------------------------




#-------------------------------------------------------------------------------------------------------------
# "Les joies du Code" information
#-------------------------------------------------------------------------------------------------------------
last_post = ljdc.get_last_post()

if ljdc.post_already_published(last_post):
    logger.info("This post has already been published. Nothing to do")
    sys.exit(0)
#-------------------------------------------------------------------------------------------------------------




#-------------------------------------------------------------------------------------------------------------
# Send new 'LJDC' post to the dedicated Slack channel
#-------------------------------------------------------------------------------------------------------------
slack.send_img_to_channel(last_post)
#-------------------------------------------------------------------------------------------------------------




#-------------------------------------------------------------------------------------------------------------
# Save new ID in file to avoid to publish a post already published
#-------------------------------------------------------------------------------------------------------------
ljdc.save_post_id_in_file(last_post)
#-------------------------------------------------------------------------------------------------------------




#-------------------------------------------------------------------------------------------------------------
logger.info("End of script. Success!")
#-------------------------------------------------------------------------------------------------------------




sys.exit(0)